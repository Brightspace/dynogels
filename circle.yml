machine:
  services:
    - docker
  node:
    version: 6.10.0

dependencies:
  pre:
    - curl -ks -u$DOCKER_USER:$DOCKER_PASS "https://d2lartifacts.artifactoryonline.com/d2lartifacts/api/npm/npm-local/auth/d2l" -o ~/.npmrc
    - docker login --email=$DOCKER_EMAIL --username=$DOCKER_USER --password=$DOCKER_PASS d2lartifacts-docker-dockerv2-local.artifactoryonline.com
    - ./circle-docker.sh

test:
  override:
    - npm run ci

deployment:
  bundle:
    branch: master
    owner: Brightspace
    commands:
      - npm install -g publish
      - publish
